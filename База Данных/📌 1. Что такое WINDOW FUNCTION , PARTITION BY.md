**Window Function** ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è **—Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ**, –Ω–æ **–Ω–µ —É–±–∏—Ä–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏ –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**, –∞ **–¥–æ–±–∞–≤–ª—è–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ**.

### üìå –ü—Ä–∏–º–µ—Ä:

–ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ —Å –∑–∞–∫–∞–∑–∞–º–∏:

| id  | –∫–ª–∏–µ–Ω—Ç | —Å—É–º–º–∞ |
| --- | ------ | ----- |
| 1   | –ê–Ω—è    | 100   |
| 2   | –ê–Ω—è    | 200   |
| 3   | –ê–Ω—è    | 300   |
| 4   | –ë–æ—Ä–∏—Å  | 400   |
| 5   | –ë–æ—Ä–∏—Å  | 100   |

–¢—ã —Ö–æ—á–µ—à—å —É–∑–Ω–∞—Ç—å, **–∫–∞–∫–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–æ–≤ —É –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞**, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º **—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É.**

SELECT
  –∫–ª–∏–µ–Ω—Ç,
  —Å—É–º–º–∞,
  SUM(—Å—É–º–º–∞) OVER (PARTITION BY –∫–ª–∏–µ–Ω—Ç) AS —Å—É–º–º–∞_–≤—Å–µ–≥–æ
FROM –∑–∞–∫–∞–∑—ã;



üßæ –†–µ–∑—É–ª—å—Ç–∞—Ç:
–∫–ª–∏–µ–Ω—Ç	—Å—É–º–º–∞	—Å—É–º–º–∞_–≤—Å–µ–≥–æ
–ê–Ω—è	100	600
–ê–Ω—è	200	600
–ê–Ω—è	300	600
–ë–æ—Ä–∏—Å	400	500
–ë–æ—Ä–∏—Å	100	500


## üß© 2. `PARTITION BY` ‚Äî —Ä–∞–∑–±–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ –≥—Ä—É–ø–ø—ã

`PARTITION BY` –≥–æ–≤–æ—Ä–∏—Ç:

> "–†–∞–∑–¥–µ–ª–∏ —Å—Ç—Ä–æ–∫–∏ –Ω–∞ –≥—Ä—É–ø–ø—ã ‚Äî –∏ –ø—É—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç **–≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã**".

üí¨ "–ü–æ—Å—á–∏—Ç–∞–π —Å—É–º–º—É –∑–∞—Ä–ø–ª–∞—Ç **–≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–¥–µ–ª–∞** –∏ –ø–æ–∫–∞–∂–∏ –≤ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ".

üìä –†–µ–∑—É–ª—å—Ç–∞—Ç:

| –°–æ—Ç—Ä—É–¥–Ω–∏–∫ | –û—Ç–¥–µ–ª | –ó–∞—Ä–ø–ª–∞—Ç–∞ | –°—É–º–º–∞ –≤ –æ—Ç–¥–µ–ª–µ |
| --------- | ----- | -------- | -------------- |
| –ò–≤–∞–Ω      | IT    | 1000     | 3000           |
| –û–ª–µ–≥      | IT    | 2000     | 3000           |
| –ê–Ω–Ω–∞      | HR    | 1500     | 2500           |
| –ú–∞—Ä–∏—è     | HR    | 1000     | 2500           |
- `PARTITION BY` ‚Äî —Ä–∞–∑–±–∏–≤–∞–µ—à—å –Ω–∞ –≥—Ä—É–ø–ø—ã
- `ORDER BY` ‚Äî –∑–∞–¥–∞—ë—à—å –ø–æ—Ä—è–¥–æ–∫ –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã
  

–§–£–ù–ö–¶–ò–ò –†–ê–ë–û–¢–ê–Æ–©–ò–ï –° WINDOWS FUNCTION 

## 1. ‚úÖ `SUM()`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** —Å—á–∏—Ç–∞–µ—Ç —Å—É–º–º—É –∑–Ω–∞—á–µ–Ω–∏–π –≤ "–æ–∫–Ω–µ".

üìå **–ü—Ä–∏–º–µ—Ä: —Å—É–º–º–∞ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É –∫–ª–∏–µ–Ω—Ç—É:**


`SELECT   
client,
order_id,   
amount,   
SUM(amount) OVER (PARTITION BY client) AS total_by_client 
FROM orders;`

üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

| client | order_id | amount | total_by_client |
| ------ | -------- | ------ | --------------- |
| –ê–Ω—è    | 1        | 100    | 600             |
| –ê–Ω—è    | 2        | 200    | 600             |
| –ê–Ω—è    | 3        | 300    | 600             |
| –ë–æ—Ä–∏—Å  | 4        | 400    | 500             |
| –ë–æ—Ä–∏—Å  | 5        | 100    | 500             |

## 2. ‚úÖ `AVG()`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** —Å—á–∏—Ç–∞–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ –æ–∫–Ω—É.

üìå **–ü—Ä–∏–º–µ—Ä: —Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ –æ—Ç–¥–µ–ª–µ:**


`SELECT   
department,   
employee,   
salary,   AVG(salary) OVER (PARTITION BY department) AS avg_salary 
FROM employees;`

## 3. ‚úÖ `ROW_NUMBER()`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –Ω—É–º–µ—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫–∏, –Ω–∞—á–∏–Ω–∞—è —Å 1, **–≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã**. –ù–æ–º–µ—Ä–∞ **–≤—Å–µ–≥–¥–∞ –∏–¥—É—Ç –ø–æ–¥—Ä—è–¥**, –¥–∞–∂–µ –ø—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö.

üìå **–ü—Ä–∏–º–µ—Ä: –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –≤ –æ—Ç–¥–µ–ª–µ –ø–æ –∑–∞—Ä–ø–ª–∞—Ç–µ:**

`SELECT   
department,   
employee,   
salary,   
ROW_NUMBER() OVER (PARTITION BY department ORDER BY salary DESC) AS row_num 
FROM employees;`


## 4. ‚úÖ `RANK()`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –≤—ã—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É, –Ω–æ **–æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º –¥–∞—ë—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–∞–Ω–≥**, –∞ —Å–ª–µ–¥—É—é—â–∏–µ —Ä–∞–Ω–≥–∏ **–ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è**.

üìå **–ü—Ä–∏–º–µ—Ä: —Ä–∞–Ω–≥ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –ø–æ –∑–∞—Ä–ø–ª–∞—Ç–µ:**

`SELECT   
employee,   
salary,   RANK() OVER (ORDER BY salary DESC) AS rank_pos 
FROM employees;`


## 5. ‚úÖ `LEAD()`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–∏** (–ø–æ –ø–æ—Ä—è–¥–∫—É).

üìå **–ü—Ä–∏–º–µ—Ä: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∏ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞—Ä–ø–ª–∞—Ç—ã:**

SELECT
  employee,
  salary,
  LEAD(salary) OVER (ORDER BY salary DESC) AS next_salary
FROM employees;

## üî• –í —á—ë–º —Å–∏–ª–∞ —ç—Ç–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π?

–û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç:

- –°—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –∏ —Å–æ—Å–µ–¥–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ (`LEAD`, `LAG`)
- –°—Ç—Ä–æ–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥–∏ –∏ —Ç–æ–ø—ã (`RANK`, `ROW_NUMBER`)
- –î–µ–ª–∞—Ç—å —Å–≤–æ–¥–∫–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Å—Ç—Ä–æ–∫ (`SUM`, `AVG`)